# üë®‚Äç‚öñÔ∏è –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–î–∞—Ç–∞:** 29 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## üìã –û–±–∑–æ—Ä

–í–ª–∞–¥–µ–ª—å—Ü—ã –∫–ª—É–±–æ–≤ –∏ —Å—Ç–∞—Ä—à–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã —Ç–µ–ø–µ—Ä—å –º–æ–≥—É—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ –Ω–∞ –∏–≥—Ä—ã **–ø—Ä—è–º–æ –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** –æ –Ω–æ–≤—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è—Ö.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞" –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
- ‚úÖ –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–ª—É–±–∞
- ‚úÖ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ª—é–±–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏–ª–∏ –Ω–∏–∂–µ
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üéØ –ö—Ç–æ –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å

### –†–æ–ª–∏ —Å –ø—Ä–∞–≤–æ–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è:
- üë®‚Äçüíº **–í–ª–∞–¥–µ–ª–µ—Ü –∫–ª—É–±–∞** (Club Owner)
- üß≠ **–°—Ç–∞—Ä—à–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä** (Senior Instructor)

### –ö–æ–≥–æ –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å:
- üë®‚Äçüíº –í–ª–∞–¥–µ–ª—å—Ü—ã –∫–ª—É–±–∞
- üß≠ –°—Ç–∞—Ä—à–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã
- üéØ –ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã

**–ü—Ä–∞–≤–∏–ª–æ:** –ú–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –ª—é–±–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏–ª–∏ –Ω–∏–∂–µ.

---

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

–ö–æ–≥–¥–∞ –∏–≥—Ä–æ–∫ —Å–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –±–æ—Ç–∞:

```
üìÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—Ä–æ–Ω–∏—Ä—É–µ—Ç –ø–ª–æ—â–∞–¥–∫—É
    ‚Üì
ü§ñ –ë–æ—Ç —Å–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ë–î
    ‚Üì
üì® –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```

### 2. –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### –î–ª—è –æ–±—ã—á–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤ (—Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞):
```
üéØ –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ!

üìç –õ–æ–∫–∞—Ü–∏—è: –ö–∞–ª—É–≥–∞ 1
üéÆ –ü–ª–æ—â–∞–¥–∫–∞: –ü–æ–ª–µ 1
üìÖ –î–∞—Ç–∞: 30.10.2025
üïê –í—Ä–µ–º—è: 14:00
üë§ Telegram: @username
```

#### –î–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∏ —Å—Ç–∞—Ä—à–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤:
```
üéØ –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ!

üìç –õ–æ–∫–∞—Ü–∏—è: –ö–∞–ª—É–≥–∞ 1
üéÆ –ü–ª–æ—â–∞–¥–∫–∞: –ü–æ–ª–µ 1
üìÖ –î–∞—Ç–∞: 30.10.2025
üïê –í—Ä–µ–º—è: 14:00
üë§ Telegram: @username
‚ö†Ô∏è –°—É–¥—å—è –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω

[üë®‚Äç‚öñÔ∏è –ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞]  ‚Üê –ö–Ω–æ–ø–∫–∞!
```

### 3. –ü—Ä–æ—Ü–µ—Å—Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

```
1. –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞"
   ‚Üì
2. –ü–æ–∫–∞–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤:
   üë®‚Äçüíº User ID 196256732
   üß≠ User ID 123456789
   üéØ User ID 987654321
   ‚ùå –û—Ç–º–µ–Ω–∞
   ‚Üì
3. –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
   ‚Üì
4. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
   ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω!
   üìÖ –î–∞—Ç–∞: 30.10.2025
   ‚è∞ –í—Ä–µ–º—è: 14:00
   üìç –ö–∞–ª—É–≥–∞ 1 - –ü–æ–ª–µ 1
   üë®‚Äç‚öñÔ∏è –°—É–¥—å—è: ID 123456789
```

---

## üíª –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

#### 1. `bot/utils/notifications.py`
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `with_assign_button`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `booking.referee_id`
- –°–æ–∑–¥–∞–µ—Ç—Å—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–æ–π "–ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞"

```python
async def notify_admins_new_booking(
    bot: Bot, 
    booking: Booking, 
    admins: List[Admin], 
    with_assign_button: bool = False
):
    # ...
    if with_assign_button and not booking.referee_id:
        keyboard = InlineKeyboardMarkup([
            [InlineKeyboardButton(
                "üë®‚Äç‚öñÔ∏è –ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞",
                callback_data=f"assign_referee_{booking.id}"
            )]
        ])
```

#### 2. `bot/handlers/booking.py`
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –†–∞–∑–¥–µ–ª–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ 2 –≥—Ä—É–ø–ø—ã:
  1. –û–±—ã—á–Ω—ã–µ –∞–¥–º–∏–Ω—ã ‚Üí –±–µ–∑ –∫–Ω–æ–ø–∫–∏
  2. –í–ª–∞–¥–µ–ª—å—Ü—ã + —Å—Ç–∞—Ä—à–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã ‚Üí —Å –∫–Ω–æ–ø–∫–æ–π

```python
# –ü–æ–ª—É—á–∞–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∏ —Å—Ç–∞—Ä—à–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤
staff_with_assign = session.query(AdminModel).join(
    ClubRole, ClubRole.user_id == AdminModel.user_id
).filter(
    ClubRole.club_id == club_id,
    ClubRole.role.in_([
        RoleType.CLUB_OWNER, 
        RoleType.SENIOR_INSTRUCTOR
    ])
).all()

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å –∫–Ω–æ–ø–∫–æ–π –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
for staff in staff_with_assign:
    # send message with keyboard
```

#### 3. `bot/handlers/roles/senior_instructor.py`
**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

**A. `assign_referee_from_notification`**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –§–∏–ª—å—Ç—Ä—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ –ø–æ –∫–ª—É–±—É

**B. `set_referee_from_notification`**
- –ù–∞–∑–Ω–∞—á–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
- –û–±–Ω–æ–≤–ª—è–µ—Ç `booking.referee_id`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

#### 4. `bot/main.py`
**–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã handlers:**
```python
application.add_handler(CallbackQueryHandler(
    assign_referee_from_notification, 
    pattern=r'^assign_referee_\d+$'
))

application.add_handler(CallbackQueryHandler(
    set_referee_from_notification, 
    pattern=r'^set_referee_\d+_\d+$'
))
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∞–≤–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏:**
   ```python
   user_roles = [r.role for r in roles]
   if not (RoleType.CLUB_OWNER in user_roles or 
           RoleType.SENIOR_INSTRUCTOR in user_roles):
       return "‚ùå –ù–µ—Ç –ø—Ä–∞–≤"
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª—É–±—É:**
   ```python
   if booking.field.location.club_id != club_id:
       return "‚ùå –î—Ä—É–≥–æ–π –∫–ª—É–±"
   ```

3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤:**
   - –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ **—Å–≤–æ–µ–≥–æ –∫–ª—É–±–∞**
   - –í–∫–ª—é—á–∞—é—Ç—Å—è –≤—Å–µ —Ä–æ–ª–∏: Owner, Senior, Instructor

---

## üìä –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `bookings`:
```sql
Column       Type        Description
---------------------------------------
id           INTEGER     PK
...
referee_id   INTEGER     FK ‚Üí admins.user_id
```

### –ó–∞–ø—Ä–æ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤:
```python
instructors = session.query(Admin).join(
    ClubRole, ClubRole.user_id == Admin.user_id
).filter(
    ClubRole.club_id == club_id,
    ClubRole.role.in_([
        RoleType.CLUB_OWNER,
        RoleType.SENIOR_INSTRUCTOR,
        RoleType.INSTRUCTOR
    ])
).all()
```

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –í–ª–∞–¥–µ–ª–µ—Ü –Ω–∞–∑–Ω–∞—á–∞–µ—Ç —Å—Ç–∞—Ä—à–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

```
1. –í–ª–∞–¥–µ–ª–µ—Ü –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
   üéØ –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ!
   üìç –ö–∞–ª—É–≥–∞ 1 - –ü–æ–ª–µ 1
   üìÖ 30.10.2025, 14:00
   ‚ö†Ô∏è –°—É–¥—å—è –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω
   [üë®‚Äç‚öñÔ∏è –ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞]

2. –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ‚Üí –í–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫:
   üë®‚Äçüíº ID 196256732  (–í–ª–∞–¥–µ–ª–µ—Ü)
   üß≠ ID 123456789   (–°—Ç–∞—Ä—à–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä)
   üéØ ID 987654321   (–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä)

3. –í—ã–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ä—à–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ (123456789)

4. –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
   ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–µ–Ω!
   üë®‚Äç‚öñÔ∏è –°—É–¥—å—è: ID 123456789
```

### –ü—Ä–∏–º–µ—Ä 2: –°—Ç–∞—Ä—à–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –æ–±—ã—á–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

```
1. –°—Ç–∞—Ä—à–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π

2. –ù–∞–∑–Ω–∞—á–∞–µ—Ç –æ–±—ã—á–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:
   üéØ ID 987654321

3. –ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏
   (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
```

---

## üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π

### –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ –º–µ–Ω—é):
```
1. –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é —Å—Ç–∞—Ä—à–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
2. –í—ã–±—Ä–∞—Ç—å "–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π"
3. –ù–∞–π—Ç–∏ –Ω—É–∂–Ω–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –ù–∞–∂–∞—Ç—å "–ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞"
5. –í—ã–±—Ä–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

‚è±Ô∏è –í—Ä–µ–º—è: ~30-40 —Å–µ–∫—É–Ω–¥
üëé 5 —à–∞–≥–æ–≤
```

### –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (–∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è):
```
1. –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É
3. –í—ã–±—Ä–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

‚è±Ô∏è –í—Ä–µ–º—è: ~5-10 —Å–µ–∫—É–Ω–¥
‚úÖ 3 —à–∞–≥–∞
```

**–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏: ~70%** üöÄ

---

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:

1. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞–º:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏
   - –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" / "–û—Ç–∫–∞–∑–∞—Ç—å—Å—è"

2. **–ò—Å—Ç–æ—Ä–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π:**
   - –ö—Ç–æ –Ω–∞–∑–Ω–∞—á–∏–ª
   - –ö–æ–≥–¥–∞ –Ω–∞–∑–Ω–∞—á–∏–ª
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

3. **–§–∏–ª—å—Ç—Ä—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:**
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤
   - –£–º–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≥—Ä—É–∑–∫–∏

4. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω:**
   - –í–º–µ—Å—Ç–æ User ID –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–º–µ–Ω–∞
   - –§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏–≥—Ä–æ–∫–æ–º**
   - –í–ª–∞–¥–µ–ª–µ—Ü –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
   - –°—Ç–∞—Ä—à–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
   - –û–±—ã—á–Ω—ã–π –∞–¥–º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –±–µ–∑ –∫–Ω–æ–ø–∫–∏

2. ‚úÖ **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –≤–ª–∞–¥–µ–ª—å—Ü–µ–º**
   - –°–ø–∏—Å–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–ª—É–±–∞
   - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

3. ‚úÖ **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ —Å—Ç–∞—Ä—à–∏–º –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º**
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤–ª–∞–¥–µ–ª—å—Ü—É
   - –î–æ—Å—Ç—É–ø –∫ —Ç–æ–π –∂–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

4. ‚úÖ **–ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –±–µ–∑ –ø—Ä–∞–≤**
   - –û–±—ã—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–µ –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É
   - –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ ‚Üí –æ—à–∏–±–∫–∞ –ø—Ä–∞–≤

5. ‚úÖ **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ –∫–ª—É–±–∞**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª—É–±—É
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –∫—Ä–æ—Å—Å-–∫–ª—É–±–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (–≤ `bot/core/constants.py`):
```python
class UIConstants:
    # –ò–∫–æ–Ω–∫–∏ —Ä–æ–ª–µ–π
    ICON_OWNER = "üë®‚Äçüíº"
    ICON_SENIOR_INSTRUCTOR = "üß≠"
    ICON_INSTRUCTOR = "üéØ"
```

### Callback patterns (–≤ `bot/main.py`):
```python
# –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–Ω–∞—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞"
pattern=r'^assign_referee_\d+$'

# –í—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
pattern=r'^set_referee_\d+_\d+$'
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ User ID –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω**
   - –ü–æ–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ User ID
   - –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –∏–º–µ–Ω–∞

2. **–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞–º**
   - –ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏
   - –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

3. **–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π**
   - –ù–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è, –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –Ω–∞–∑–Ω–∞—á–∏–ª
   - –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å

---

## üéì –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ä–æ–ª–∏ —Å –ø—Ä–∞–≤–æ–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è:

1. –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –≤ `booking.py`:
```python
ClubRole.role.in_([
    RoleType.CLUB_OWNER, 
    RoleType.SENIOR_INSTRUCTOR,
    RoleType.NEW_ROLE  # –î–æ–±–∞–≤–∏—Ç—å –∑–¥–µ—Å—å
])
```

2. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –≤ `senior_instructor.py`:
```python
if not (RoleType.CLUB_OWNER in user_roles or 
        RoleType.SENIOR_INSTRUCTOR in user_roles or
        RoleType.NEW_ROLE in user_roles):
```

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –Ω–∞–∑–Ω–∞—á–∞–µ–º—ã—Ö:

–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –≤ `assign_referee_from_notification`:
```python
ClubRole.role.in_([
    RoleType.CLUB_OWNER,
    RoleType.SENIOR_INSTRUCTOR,
    RoleType.INSTRUCTOR,
    # –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–æ–ª–∏
])
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [RBAC_ARCHITECTURE.md](../architecture/RBAC_ARCHITECTURE.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–æ–ª–µ–π
- [NEW_FEATURES_GUIDE.md](NEW_FEATURES_GUIDE.md) - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å—É–¥–µ–π —á–µ—Ä–µ–∑ –º–µ–Ω—é
- [QUICK_BOOKING_FEATURE.md](../fixes/QUICK_BOOKING_FEATURE.md) - –ë—ã—Å—Ç—Ä–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- [x] –û–±–Ω–æ–≤–ª–µ–Ω `notifications.py` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –∫–Ω–æ–ø–∫–∏
- [x] –†–∞–∑–¥–µ–ª–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ `booking.py`
- [x] –°–æ–∑–¥–∞–Ω—ã handlers –≤ `senior_instructor.py`
- [x] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã handlers –≤ `main.py`
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∫–Ω–æ–ø–æ–∫
- [x] –ë–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

**–î–∞—Ç–∞:** 29 –æ–∫—Ç—è–±—Ä—è 2025 | **–í–µ—Ä—Å–∏—è:** 2.1

